(function (e, c, a, g) { var d = "lwMultiSelect"; var f = { addAllText: "Select All", removeAllText: "Remove All", selectedLabel: "Values accepted", maxSelect: 0, maxText: "", onChange: "" }; function b(i, h) { this.$element = e(i); if (h) { h.maxSelect = parseInt(h.maxSelect) || f.maxSelect } this.options = e.extend({}, f, h); this._defaults = f; this._name = d; this.totalItem = 0; this.$mainContainer = ""; this.$leftDiv = ""; this.$rightDiv = ""; this.$leftHead = ""; this.$rightHead = ""; this.$availList = ""; this.$selectedList = ""; this.$counter = ""; this.init() } b.prototype = { init: function () { var h = ""; this.$element.hide(); this.$mainContainer = e('<div class="lwms-main lwms-cf"></div>').insertAfter(this.$element); this.$leftDiv = e('<div class="lwms-left"></div>').appendTo(this.$mainContainer); this.$rightDiv = e('<div class="lwms-right"></div>').appendTo(this.$mainContainer); if (this.options.maxSelect != 0) { h = '<div class="lwms-filterhead"><div class="lwms-maxtext">' + this.options.maxText + "</div></div>" } else { h = '<div class="lwms-filterhead"><a href="#" class="lwms-addall">' + this.options.addAllText + '</a>&nbsp; | &nbsp;<a href="#" class="lwms-removeall">' + this.options.removeAllText + "</a></div>" } this.$leftHead = e(h).appendTo(this.$leftDiv); this.$rightHead = e('<div class="lwms-filterhead"><span class="lwms-filcount"></span> ' + this.options.selectedLabel + "</div>").appendTo(this.$rightDiv); this.$availList = e('<ul class="lwms-list lwms-available"></ul>').appendTo(this.$leftDiv); this.$selectedList = e('<ul class="lwms-list"></ul>').appendTo(this.$rightDiv); this.$counter = this.$mainContainer.find(".lwms-filcount"); this.updateList(); this.initEvents() }, isBelowMax: function () { return (this.$selectedList.children().length < this.options.maxSelect) }, selectItem: function (h) { if (this.options.maxSelect == 0 || this.isBelowMax()) { var i = e(h); i.clone().appendTo(this.$selectedList); i.addClass("lwms-selected"); this.$element.find('option[value="' + i.data("value") + '"]').attr("selected", "selected"); this.updateCount(); this.triggerChange() } }, removeItem: function (h) { var i = e(h); this.$availList.find('li[data-value="' + i.data("value") + '"]').removeClass("lwms-selected"); this.$element.find('option[value="' + i.data("value") + '"]').removeAttr("selected"); i.remove(); this.updateCount(); this.triggerChange() }, selectAll: function () { if (this.options.maxSelect == 0) { var h, i = this.$availList.find("li:visible"); this.$selectedList.append(i.clone()); h = i.map(function () { return e(this).data("value").toString() }).get(); this.$element.find("option").filter(function (j) { return (e.inArray(this.value, h) > -1) }).attr("selected", "selected"); i.addClass("lwms-selected"); this.updateCount(); this.triggerChange() } }, removeAll: function () { this.$availList.find("li").removeClass("lwms-selected"); this.$selectedList.empty(); this.$element.children().removeAttr("selected"); this.updateCount(); this.triggerChange() }, initEvents: function () { var h = this; this.$availList.off("click.lwmultiselect", "li"); this.$availList.on("click.lwmultiselect", "li", function (i) { i.preventDefault(); h.selectItem(this) }); this.$selectedList.off("click.lwmultiselect", "li"); this.$selectedList.on("click.lwmultiselect", "li", function (i) { i.preventDefault(); h.removeItem(this) }); this.$mainContainer.off("click.lwmultiselect", ".lwms-addall"); this.$mainContainer.on("click.lwmultiselect", ".lwms-addall", function (i) { i.preventDefault(); h.selectAll() }); this.$mainContainer.off("click.lwmultiselect", ".lwms-removeall"); this.$mainContainer.on("click.lwmultiselect", ".lwms-removeall", function (i) { i.preventDefault(); h.removeAll() }) }, updateList: function () { var l = this, j = "", i = "", n, h, m, k = ""; this.$selectedList.empty(); this.$availList.empty(); this.totalItem = this.$element.children().length; this.$element.children().each(function () { k = ""; n = e(this); h = n.prop("value"); m = n.text(); if (n.is(":selected")) { j += '<li class="lwms-selectli" data-value="' + h + '">' + m + "</li>"; k = " lwms-selected" } i += '<li class="lwms-selectli' + k + '" data-value="' + h + '">' + m + "</li>" }); this.$selectedList.html(j); this.$availList.html(i); this.updateCount() }, triggerChange: function () { if (this.options.onChange != "") { this.options.onChange() } }, updateCount: function () { this.$counter.text(this.$selectedList.children().length + "/" + ((this.options.maxSelect == 0) ? this.totalItem : this.options.maxSelect)) } }; e.fn[d] = function (h) { return this.each(function () { if (!e.data(this, "plugin_" + d)) { e.data(this, "plugin_" + d, new b(this, h)) } }) } })(jQuery, window, document);